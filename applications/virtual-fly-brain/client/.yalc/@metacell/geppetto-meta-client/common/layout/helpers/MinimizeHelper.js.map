{"version":3,"file":"MinimizeHelper.js","names":["MinimizeHelper","isMinimizeEnabled","model","borders","getBorderSet","getBorders","borderToMinimizeTo","findBorderToMinimizeTo","minimizeBorderID","getId","MINIMIZED_PANEL","store","widget","panelName","panel","renderValues","getChildren","length","buttons","push","minimizeWidget","getSelectedNode","widgetId","updatedWidget","getWidget","status","WidgetStatus","MINIMIZED","defaultPanel","dispatch","updateWidget","console","warn","previousWidget","mergedWidget","restoreWidget","tabset","getNodeById","undefined","createTabSet","defaultPosition","defaultWeight","moveWidget"],"sources":["../../../../src/common/layout/helpers/MinimizeHelper.tsx"],"sourcesContent":["import * as React from 'react';\nimport {findBorderToMinimizeTo, getWidget} from \"../utils\";\nimport {Store} from \"redux\";\nimport {Widget, WidgetStatus} from \"../model\";\nimport {updateWidget} from \"../actions\";\n// @ts-ignore\nimport Model from '@metacell/geppetto-meta-ui/flex-layout/src/model/Model';\nimport {MINIMIZED_PANEL} from '../../layout';\nimport {createTabSet, moveWidget} from \"./FlexLayoutHelper\";\n\n\nexport class MinimizeHelper {\n    private readonly isMinimizeEnabled: boolean;\n    private readonly minimizeBorderID: string;\n    private store: Store;\n    private model: Model;\n\n    constructor(isMinimizeEnabled, model) {\n        const borders = model.getBorderSet().getBorders()\n        const borderToMinimizeTo = findBorderToMinimizeTo(borders)\n        this.isMinimizeEnabled = isMinimizeEnabled;\n        this.model = model\n        this.minimizeBorderID = borderToMinimizeTo?.getId() || MINIMIZED_PANEL;\n        this.store = null;\n    }\n\n    getIsMinimizeEnabled() {\n        return this.isMinimizeEnabled;\n    }\n\n    setStore(store: Store<any>) {\n        this.store = store;\n    }\n\n    isMinimized(widget: Widget): boolean {\n        return widget.panelName == this.minimizeBorderID;\n    }\n\n    addMinimizeButtonToTabset(panel, renderValues) {\n        if (this.isMinimizeEnabled && this.minimizeBorderID) {\n            if (panel.getChildren().length > 0) {\n                renderValues.buttons.push(\n                    <div\n                        key={panel.getId()}\n                        className=\"fa fa-window-minimize customIconFlexLayout minimizeButton\"\n                        onClick={() => {\n                            this.minimizeWidget(panel.getSelectedNode().getId());\n                        }}\n                    />\n                );\n            }\n        }\n    }\n\n    /**\n     * Minimize a widget.\n     *\n     * @param widgetId\n     * @private\n     */\n    minimizeWidget(widgetId) {\n        if(this.store && this.minimizeBorderID) {\n            \n            let updatedWidget = { ...getWidget(this.store, widgetId) };\n            updatedWidget.status = WidgetStatus.MINIMIZED;\n            updatedWidget.defaultPanel = updatedWidget.panelName;\n            updatedWidget.panelName = this.minimizeBorderID;\n            this.store.dispatch(updateWidget(updatedWidget))\n        } else{\n            console.warn(\"Unable to minimize widget\");\n        }\n    }\n\n    restoreWidgetIfNecessary(previousWidget: Widget, mergedWidget: Widget): boolean {\n        if (previousWidget.status != mergedWidget.status && previousWidget.status == WidgetStatus.MINIMIZED) {\n            this.restoreWidget(mergedWidget);\n            return true\n        }\n        return false\n    }\n\n    /**\n     * Restore widget.\n     *\n     * @param widget\n     * @private\n     */\n    restoreWidget(widget: Widget) {\n        const { model } = this;\n        widget.panelName = widget.defaultPanel;\n        const panelName = widget.panelName;\n        let tabset = model.getNodeById(panelName);\n        if (tabset === undefined) {\n            createTabSet(model, panelName, widget.defaultPosition, widget.defaultWeight);\n        }\n        moveWidget(model, widget);\n    }\n}"],"mappings":"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"}