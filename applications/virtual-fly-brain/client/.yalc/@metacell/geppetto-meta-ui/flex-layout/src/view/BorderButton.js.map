{"version":3,"file":"BorderButton.js","names":["React","_interopRequireWildcard","require","_","_Actions","_interopRequireDefault","_Rect","_ICloseType","_Types","obj","__esModule","_getRequireWildcardCache","e","WeakMap","r","t","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","o","Symbol","iterator","constructor","prototype","BorderButton","exports","props","layout","node","selected","border","iconFactory","titleFactory","icons","selfRef","useRef","onMouseDown","event","message","i18nName","I18nLabel","Move_Tab","getName","dragStart","isEnableDrag","onClick","event2","undefined","customizeBottomBar","isClosable","closeType","getCloseType","ICloseType","Always","Visible","window","matchMedia","matches","onClose","doAction","Actions","deleteTab","getId","onCloseMouseDown","stopPropagation","useLayoutEffect","updateRect","clientRect","getDomRect","current","getBoundingClientRect","_setTabRect","Rect","left","top","width","height","cm","getClassName","classNames","CLASSES","FLEXLAYOUT__BORDER_BUTTON","FLEXLAYOUT__BORDER_BUTTON_","FLEXLAYOUT__BORDER_BUTTON__SELECTED","FLEXLAYOUT__BORDER_BUTTON__UNSELECTED","leadingContent","titleContent","name","isTitleObject","titleObj","getIcon","createElement","src","alt","buttons","renderState","leading","content","customizeTab","_setRenderedName","className","FLEXLAYOUT__BORDER_BUTTON_CONTENT","FLEXLAYOUT__BORDER_BUTTON_LEADING","isEnableClose","closeTitle","Close_Tab","push","key","title","FLEXLAYOUT__BORDER_BUTTON_TRAILING","onTouchStart","close","ref","style"],"sources":["../../../../src/flex-layout/src/view/BorderButton.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { I18nLabel } from \"..\";\nimport Actions from \"../model/Actions\";\nimport TabNode from \"../model/TabNode\";\nimport Rect from \"../Rect\";\nimport { IIcons, ILayoutCallbacks, ITitleObject } from \"./Layout\";\nimport { ICloseType } from \"../model/ICloseType\";\nimport { CLASSES } from \"../Types\";\n\n/** @hidden @internal */\nexport interface IBorderButtonProps {\n    layout: ILayoutCallbacks;\n    node: TabNode;\n    selected: boolean;\n    border: string;\n    iconFactory?: (node: TabNode) => React.ReactNode | undefined;\n    titleFactory?: (node: TabNode) => React.ReactNode | undefined;\n    icons?: IIcons;\n}\n\n/** @hidden @internal */\nexport const BorderButton = (props: IBorderButtonProps) => {\n    const { layout, node, selected, border, iconFactory, titleFactory, icons } = props;\n    const selfRef = React.useRef<HTMLDivElement | null>(null);\n\n    const onMouseDown = (event: React.MouseEvent<HTMLDivElement, MouseEvent> | React.TouchEvent<HTMLDivElement>) => {\n        const message = layout.i18nName(I18nLabel.Move_Tab, node.getName());\n        props.layout.dragStart(event, message, node, node.isEnableDrag(), onClick, (event2: Event) => undefined);\n    };\n\n    const onClick = () => {\n        // layout.doAction(Actions.selectTab(node.getId()));\n        props.layout.customizeBottomBar(node)\n    };\n\n    const isClosable = () => {\n        const closeType = node.getCloseType();\n        if (selected || closeType === ICloseType.Always) {\n            return true;\n        }\n        if (closeType === ICloseType.Visible) {\n            // not selected but x should be visible due to hover\n            if (window.matchMedia && window.matchMedia(\"(hover: hover) and (pointer: fine)\").matches) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    const onClose = (event: React.MouseEvent<HTMLDivElement>) => {\n        if (isClosable()) {\n            layout.doAction(Actions.deleteTab(node.getId()));\n        } else {\n            onClick();\n        }\n    };\n\n    const onCloseMouseDown = (event: React.MouseEvent<HTMLDivElement> | React.TouchEvent<HTMLDivElement>) => {\n        event.stopPropagation();\n    };\n\n    React.useLayoutEffect(() => {\n        updateRect();\n    });\n\n    const updateRect = () => {\n        // record position of tab in border\n        const clientRect = layout.getDomRect();\n        const r = selfRef.current!.getBoundingClientRect();\n        node._setTabRect(new Rect(r.left - clientRect.left, r.top - clientRect.top, r.width, r.height));\n    };\n\n    const cm = layout.getClassName;\n    let classNames = cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON) + \" \" + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_ + border);\n\n    if (selected) {\n        classNames += \" \" + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON__SELECTED);\n    } else {\n        classNames += \" \" + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON__UNSELECTED);\n    }\n\n    if (node.getClassName() !== undefined) {\n        classNames += \" \" + node.getClassName();\n    }\n\n    let leadingContent = iconFactory ? iconFactory(node) : undefined;\n    let titleContent: React.ReactNode = node.getName();\n    let name = node.getName();\n\n    function isTitleObject(obj: any): obj is ITitleObject {\n        return obj.titleContent !== undefined \n      }\n\n    if (titleFactory !== undefined) {\n        const titleObj = titleFactory(node);\n        if (titleObj !== undefined) {\n            if (typeof titleObj === \"string\") {\n                titleContent = titleObj as string;\n                name = titleObj as string;\n            } else if (isTitleObject(titleObj)) {\n                titleContent = titleObj.titleContent;\n                name = titleObj.name;\n            } else {\n                titleContent = titleObj;\n            }\n        }\n    }\n\n    if (typeof leadingContent === undefined && typeof node.getIcon() !== undefined) {\n        leadingContent = <img src={node.getIcon()} alt=\"leadingContent\" />;\n    }\n\n    let buttons: any[] = [];\n\n    // allow customization of leading contents (icon) and contents\n    const renderState = { leading: leadingContent, content: titleContent, name, buttons };\n    layout.customizeTab(node, renderState);\n    node._setRenderedName(renderState.name);\n\n    const content = <div className={cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_CONTENT)}>{renderState.content}</div>;\n    const leading = <div className={cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_LEADING)}>{renderState.leading}</div>;\n\n    if (node.isEnableClose()) {\n        const closeTitle = layout.i18nName(I18nLabel.Close_Tab);\n        buttons.push(\n            <div key=\"close\" title={closeTitle} className={cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_TRAILING)} onMouseDown={onCloseMouseDown} onClick={onClose} onTouchStart={onCloseMouseDown}>\n                {icons?.close}\n            </div>\n        );\n    }\n\n    return (\n        <div ref={selfRef} style={{}} className={classNames} onMouseDown={onMouseDown} onTouchStart={onMouseDown}>\n            {leading}\n            {content}\n            {buttons}\n        </div>\n    );\n};\n"],"mappings":"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","ignoreList":[]}