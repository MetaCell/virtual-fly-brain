{"version":3,"file":"SOLRclient.js","names":["_axios","_interopRequireDefault","require","obj","__esModule","globalConfiguration","solrConfiguration","params","json","query_settings","getResultsSOLR","searchString","returnResults","sorter","configuration","url","undefined","tempConfig","JSON","parse","stringify","q","replace","axios","get","concat","then","response","blob","Blob","refineResults","blobUrl","window","URL","createObjectURL","worker","Worker","onmessage","e","data","resultMessage","results","revokeObjectURL","postMessage","message","docs","value","error","console","log","a","b","InputString","self","spotlightString","label","toLowerCase","split","join","id","indexOf","refinedResults","map","item","hasOwnProperty","synonym","innerItem","newRecord","Object","keys","key","push","sortedResults","sort","close"],"sources":["../../../src/search/datasources/SOLRclient.tsx"],"sourcesContent":["import axios from 'axios';\n\nconst globalConfiguration:any = {\n    \"url\": \"https://solr-dev.virtualflybrain.org/solr/ontology/select\",\n    \"query_settings\":\n    {\n        \"q\": \"$SEARCH_TERM$ OR $SEARCH_TERM$* OR *$SEARCH_TERM$*\",\n        \"defType\": \"edismax\",\n        \"qf\": \"label synonym label_autosuggest_ws label_autosuggest_e label_autosuggest synonym_autosuggest_ws synonym_autosuggest_e synonym_autosuggest shortform_autosuggest has_narrow_synonym_annotation has_broad_synonym_annotation\",\n        \"indent\": \"true\",\n        \"fl\": \"short_form,label,synonym,id,type,has_narrow_synonym_annotation,has_broad_synonym_annotation,facets_annotation\",\n        \"start\": \"0\",\n        \"fq\": [\n            \"type:class OR type:individual OR type:property\",\n            \"ontology_name:(vfb)\",\n            \"shortform_autosuggest:VFB* OR shortform_autosuggest:FB* OR is_defining_ontology:true\"\n        ],\n        \"rows\": \"100\",\n        \"wt\": \"json\",\n        \"bq\": \"is_obsolete:false^100.0 shortform_autosuggest:VFB*^110.0 shortform_autosuggest:FBbt*^100.0 is_defining_ontology:true^100.0 label_s:\\\"\\\"^2 synonym_s:\\\"\\\" in_subset_annotation:BRAINNAME^3 short_form:FBbt_00003982^2\"\n    }\n};\n\nlet solrConfiguration:any = {\n    params: {\n        json: {\n          params: globalConfiguration.query_settings\n        }\n    }\n}\n\nexport function getResultsSOLR ( searchString: string, returnResults: Function, sorter: Function, configuration?: any) {\n    var url:string = configuration.url;\n\n    if (configuration.url === undefined) {\n        url = globalConfiguration.url;\n    }\n    if (configuration.query_settings !== undefined) {\n        solrConfiguration.params.json.params = configuration.query_settings;\n    }\n\n    // hack to clone the object\n    let tempConfig:any = JSON.parse(JSON.stringify(solrConfiguration));\n    tempConfig.params.json.params.q = solrConfiguration.params.json.params.q.replace(/\\$SEARCH_TERM\\$/g, searchString);\n\n    axios.get(`${url}`, tempConfig)\n        .then(function(response) {\n            var blob = new Blob([\"onmessage = \" + refineResults]);\n            var blobUrl = window.URL.createObjectURL(blob);\n\n            var worker = new Worker(blobUrl);\n            worker.onmessage = function (e) {\n                switch(e.data.resultMessage) {\n                    case \"OK\":\n                        returnResults(\"OK\", e.data.params.results, searchString);\n                        window.URL.revokeObjectURL(blobUrl);\n                        break;\n                }\n            };\n            worker.postMessage({message: \"refine\", params: {results: response.data.response.docs, value: searchString}});\n\n            // refineResults(searchString, response.data.response.docs, returnResults);\n        })\n        .catch(function(error) {\n            console.log('%c --- SOLR datasource error --- ', 'background: black; color: red');\n            console.log(error);\n            returnResults(\"ERROR\", undefined, searchString);\n        })\n};\n\nfunction refineResults(e) {\n    const sorter = function (a, b) {\n        var InputString = self.spotlightString;\n\n        // move exact matches to top\n        if (InputString == a.label) {\n            return -1;\n        }\n        if (InputString == b.label) {\n            return 1;\n        }\n        // close match without case matching\n        if (InputString.toLowerCase() == a.label.toLowerCase()) {\n            return -1;\n        }\n        if (InputString.toLowerCase() == b.label.toLowerCase()) {\n            return 1;\n        }\n        // match ignoring joinging nonwords\n        if (InputString.toLowerCase().split(/\\W+/).join(' ') == a.label.toLowerCase().split(/\\W+/).join(' ')) {\n            return -1;\n        }\n        if (InputString.toLowerCase().split(/\\W+/).join(' ') == b.label.toLowerCase().split(/\\W+/).join(' ')) {\n            return 1;\n        }\n        // match against id\n        if (InputString.toLowerCase() == a.id.toLowerCase()) {\n            return -1;\n        }\n        if (InputString.toLowerCase() == b.id.toLowerCase()) {\n            return 1;\n        }\n        // pick up any match without nonword join character match\n        if (a.label.toLowerCase().split(/\\W+/).join(' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ')) < 0 && b.label.toLowerCase().split(/\\W+/).join(' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ')) > -1) {\n            return 1;\n        }\n        if (b.label.toLowerCase().split(/\\W+/).join(' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ')) < 0 && a.label.toLowerCase().split(/\\W+/).join(' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ')) > -1) {\n            return -1;\n        }\n        // also with underscores ignored\n        if (a.label.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ')) < 0 && b.label.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ')) > -1) {\n            return 1;\n        }\n        if (b.label.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ')) < 0 && a.label.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ').indexOf(InputString.toLowerCase().split(/\\W+/).join(' ').replace('_', ' ')) > -1) {\n            return -1;\n        }\n        // if not found in one then advance the other\n        if (a.label.toLowerCase().indexOf(InputString.toLowerCase()) < 0 && b.label.toLowerCase().indexOf(InputString.toLowerCase()) > -1) {\n            return 1;\n        }\n        if (b.label.toLowerCase().indexOf(InputString.toLowerCase()) < 0 && a.label.toLowerCase().indexOf(InputString.toLowerCase()) > -1) {\n            return -1;\n        }\n        // if the match is closer to start than the other move up\n        if (a.label.toLowerCase().indexOf(InputString.toLowerCase()) > -1 && a.label.toLowerCase().indexOf(InputString.toLowerCase()) < b.label.toLowerCase().indexOf(InputString.toLowerCase())) {\n            return -1;\n        }\n        if (b.label.toLowerCase().indexOf(InputString.toLowerCase()) > -1 && b.label.toLowerCase().indexOf(InputString.toLowerCase()) < a.label.toLowerCase().indexOf(InputString.toLowerCase())) {\n            return 1;\n        }\n        // if the match in the id is closer to start then move up\n        if (a.id.toLowerCase().indexOf(InputString.toLowerCase()) > -1 && a.id.toLowerCase().indexOf(InputString.toLowerCase()) < b.id.toLowerCase().indexOf(InputString.toLowerCase())) {\n            return -1;\n        }\n        if (b.id.toLowerCase().indexOf(InputString.toLowerCase()) > -1 && b.id.toLowerCase().indexOf(InputString.toLowerCase()) < a.id.toLowerCase().indexOf(InputString.toLowerCase())) {\n            return 1;\n        }\n        // move the shorter synonyms to the top\n        if (a.label < b.label) {\n            return -1;\n        } else if (a.label > b.label) {\n            return 1;\n        } else {\n            return 0;\n        } // if nothing found then do nothing.\n    };\n\n    self.spotlightString = e.data.params.value;\n    var refinedResults:Array<any> = [];\n    e.data.params.results.map(item => {\n        if (item.hasOwnProperty(\"synonym\")) {\n            item.synonym.map(innerItem => {\n                let newRecord:any = {}\n                if (innerItem !== item.label) {\n                    Object.keys(item).map(key => {\n                        switch(key) {\n                            case \"label\":\n                                newRecord[key] = innerItem + \" (\" + item.label + \")\";\n                                break;\n                            case \"synonym\":\n                                break;\n                            default:\n                                newRecord[key] = item[key];\n                        }\n                    });\n                    refinedResults.push(newRecord);\n                }\n            });\n            let newRecord:any = {}\n            Object.keys(item).map(key => {\n                if (key !== \"synonym\") {\n                    if (key === \"label\") {\n                        newRecord[key] = item[key] + \" (\" + item[\"short_form\"] + \")\";\n                    } else {\n                        newRecord[key] = item[key];\n                    }\n                }\n            });\n            refinedResults.push(newRecord);\n        } else {\n            let newRecord:any = {}\n            Object.keys(item).map(key => {\n                if (key === \"label\") {\n                    newRecord[key] = item[key] + \" (\" + item[\"short_form\"] + \")\";\n                } else {\n                    newRecord[key] = item[key];\n                }\n            });\n            refinedResults.push(newRecord);\n        }\n    });\n\n    var sortedResults: Array<any> = refinedResults.sort(sorter);\n    this.postMessage({resultMessage: \"OK\", params: {results: sortedResults}});\n    self.close();\n}\n"],"mappings":"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","ignoreList":[]}