{"version":3,"file":"THREEx.KeyboardState.js","names":["define","THREEx","window","KeyboardState","keyCodes","modifiers","self","_onKeyDown","event","_onKeyChange","_onKeyUp","document","addEventListener","prototype","destroy","removeEventListener","MODIFIERS","ALIAS","pressed","keyCode","shiftKey","ctrlKey","altKey","metaKey","keyDesc","keys","split","i","length","key","indexOf","Object","toUpperCase","charCodeAt"],"sources":["../../src/external/THREEx.KeyboardState.js"],"sourcesContent":["/*\n * THREEx.KeyboardState.js keep the current state of the keyboard.\n * It is possible to query it at any time. No need of an event.\n * This is particularly convenient in loop driven case, like in\n * 3D demos or games.\n *\n * # Usage\n *\n * **Step 1**: Create the object\n *\n * ```var keyboard = new THREEx.KeyboardState();```\n *\n * **Step 2**: Query the keyboard state\n *\n * This will return true if shift and A are pressed, false otherwise\n *\n * ```keyboard.pressed(\"shift+A\")```\n *\n * **Step 3**: Stop listening to the keyboard\n *\n * ```keyboard.destroy()```\n *\n * NOTE: this library may be nice as standaline. independant from three.js\n * - rename it keyboardForGame\n *\n * # Code\n *\n */\n\ndefine(function () {\n\n  /** @namespace */\n  var THREEx = THREEx || {};\n  window.THREEx = THREEx;\n  /**\n   * - NOTE: it would be quite easy to push event-driven too\n   *   - microevent.js for events handling\n   *   - in this._onkeyChange, generate a string from the DOM event\n   *   - use this as event name\n   */\n  THREEx.KeyboardState = function () {\n    // to store the current state\n    this.keyCodes = {};\n    this.modifiers = {};\n\n    // create callback to bind/unbind keyboard events\n    var self = this;\n    this._onKeyDown = function (event){\n      self._onKeyChange(event, true); \n    };\n    this._onKeyUp = function (event){\n      self._onKeyChange(event, false);\n    };\n\n    // bind keyEvents\n    document.addEventListener(\"keydown\", this._onKeyDown, false);\n    document.addEventListener(\"keyup\", this._onKeyUp, false);\n  };\n\n  /**\n   * To stop listening of the keyboard events\n   */\n  THREEx.KeyboardState.prototype.destroy = function () {\n    // unbind keyEvents\n    document.removeEventListener(\"keydown\", this._onKeyDown, false);\n    document.removeEventListener(\"keyup\", this._onKeyUp, false);\n  };\n\n  THREEx.KeyboardState.MODIFIERS = ['shift', 'ctrl', 'alt', 'meta'];\n  THREEx.KeyboardState.ALIAS = {\n    'left': 37,\n    'up': 38,\n    'right': 39,\n    'down': 40,\n    'space': 32,\n    'pageup': 33,\n    'pagedown': 34,\n    'enter': 13,\n    'tab': 9,\n    'escape': 27\n  };\n\n  /**\n   * to process the keyboard dom event\n   */\n  THREEx.KeyboardState.prototype._onKeyChange = function (event, pressed) {\n    /*\n     * log to debug\n     * console.log(\"onKeyChange\", event, pressed, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\n     */\n\n    // update this.keyCodes\n    var keyCode = event.keyCode;\n    this.keyCodes[keyCode] = pressed;\n\n    // update this.modifiers\n    this.modifiers['shift'] = event.shiftKey;\n    this.modifiers['ctrl'] = event.ctrlKey;\n    this.modifiers['alt'] = event.altKey;\n    this.modifiers['meta'] = event.metaKey;\n  };\n\n  /**\n   * query keyboard state to know if a key is pressed of not\n   *\n   * @param {String} keyDesc the description of the key. format : modifiers+key e.g shift+A\n   * @returns {Boolean} true if the key is pressed, false otherwise\n   */\n  THREEx.KeyboardState.prototype.pressed = function (keyDesc) {\n    var keys = keyDesc.split(\"+\");\n    for (var i = 0; i < keys.length; i++){\n      var key = keys[i];\n      var pressed;\n      if ( THREEx.KeyboardState.MODIFIERS.indexOf( key ) !== -1 ){\n        pressed = this.modifiers[key];\n      } else if ( Object.keys(THREEx.KeyboardState.ALIAS).indexOf( key ) != -1 ){\n        pressed = this.keyCodes[ THREEx.KeyboardState.ALIAS[key] ];\n      } else {\n        pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)];\n      }\n      if ( !pressed){\n        return false;\n      }\n    }\n    return true;\n  };\n\n  return THREEx;\n\n});\n"],"mappings":"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"}