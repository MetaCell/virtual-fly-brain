{"version":3,"file":"ComponentFactory.js","names":["ComponentFactory","componentsMap","getComponents","addExistingComponent","componentType","component","override","c","id","push","removeExistingComponent","index","indexOf","splice","getComponentById","componentId","undefined","camelize","str","replace","match","toUpperCase","toLowerCase","getAvailableComponentId","available","components","componentsIndex","props","_addComponent","componentToAdd","properties","container","callback","isWidget","document","getElementById","type","React","createFactory","_renderComponent","renderedComponent","window","renderComponent","ReactDOM","render"],"sources":["../../src/components/ComponentFactory.js"],"sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nconst ComponentFactory = {\n  componentsMap: {},\n\n  getComponents: function () {\n    return this.componentsMap;\n  },\n\n  addExistingComponent (componentType, component, override) {\n    if (!(componentType in this.componentsMap)) {\n      this.componentsMap[componentType] = [];\n    }\n    if (override) {\n      var componentsMap = this.componentsMap[componentType];\n\n      for (var c in componentsMap) {\n        if (component.id === componentsMap[c].id) {\n          componentsMap[c] = component;\n          // var index =  c;\n          return;\n        }\n      }\n    }\n    this.componentsMap[componentType].push(component);\n  },\n\n  removeExistingComponent (componentType, component) {\n    if (componentType in this.componentsMap) {\n      var index = this.componentsMap[componentType].indexOf(component);\n      if (index > -1) {\n        this.componentsMap[componentType].splice(index, 1);\n      }\n    }\n  },\n\n  getComponentById (componentType, componentId) {\n    var componentsMap = this.componentsMap[componentType];\n    for (var c in componentsMap) {\n      if (componentId === componentsMap[c].id) {\n        return componentsMap[c];\n      }\n    }\n    return undefined;\n  },\n\n  camelize (str) {\n    return str.replace(/(?:^\\w|[A-Z]|\\b\\w|\\s+)/g, function (match, index) {\n      if (+match === 0) {\n        return \"\";\n      } // or if (/\\s+/.test(match)) for white spaces\n      return index == 0 ? match.toUpperCase() : match.toLowerCase();\n    });\n  },\n\n  /**\n   * Get an available id for an specific widget\n   *\n   * @module WidgetUtility\n   * @param {String} prefix\n   * @param {Array} widgetsList\n   * @returns {String} id - Available id for a widget\n   */\n  getAvailableComponentId (componentType) {\n    var index = 0;\n    var id = \"\";\n    var available;\n\n    var components = [];\n    if (componentType in this.componentsMap) {\n      components = this.componentsMap[componentType];\n    }\n\n    do {\n      index++;\n      id = componentType + index;\n      available = true;\n\n      for (var componentsIndex in components) {\n        if (\n          components[componentsIndex].props.id.toUpperCase() == id.toUpperCase()\n        ) {\n          available = false;\n          break;\n        }\n      }\n    } while (available == false);\n\n    return this.camelize(id);\n  },\n\n  _addComponent: function (\n    componentToAdd,\n    componentType,\n    properties,\n    container,\n    callback,\n    isWidget\n  ) {\n    // Prepare properties\n    if (properties === undefined) {\n      properties = {};\n    }\n    properties.componentType = componentType;\n    if (!(\"id\" in properties)) {\n      properties[\"id\"] = this.getAvailableComponentId(componentType);\n    }\n    if (!(\"isStateless\" in properties)) {\n      properties[\"isStateless\"] = false;\n    }\n\n    if (container == null && isWidget) {\n      // FIXME Redundant, see addWidget\n      container = document.getElementById(\"widgetContainer\");\n    }\n    properties[\"parentContainer\"] = container;\n\n    // Create component/widget\n    var type = componentToAdd;\n\n    var component = React.createFactory(type)(properties);\n\n    return component;\n  },\n\n  _renderComponent: function (\n    component,\n    componentType,\n    properties,\n    container,\n    callback,\n    isWidget\n  ) {\n    var renderedComponent = (window[properties.id] = this.renderComponent(\n      component,\n      container,\n      callback\n    ));\n\n    renderedComponent.container = container;\n\n    // Register in component map\n    if (!(componentType in this.componentsMap)) {\n      this.componentsMap[componentType] = [];\n    }\n    this.componentsMap[componentType].push(renderedComponent);\n    return renderedComponent;\n  },\n\n  renderComponent: function (component, container, callback) {\n    return ReactDOM.render(component, container, callback);\n  },\n};\n\nexport default ComponentFactory;\n"],"mappings":"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"}