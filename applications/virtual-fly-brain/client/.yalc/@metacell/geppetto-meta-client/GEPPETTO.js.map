{"version":3,"file":"GEPPETTO.js","names":["EventManager","require","Events","Resources","Manager","ComponentFactory","ModelFactory","GEPPETTO","debug","isKeyPressed","key","keyboard","pressed","log","msg","d","Date","curr_hour","getHours","curr_min","getMinutes","curr_sec","getSeconds","curr_msec","getMilliseconds","console","trackActivity","category","action","opt_label","opt_value","opt_noninteraction","_gaq","push","winHeight","window","innerHeight","document","documentElement","body","clientHeight","trigger","args","length","error","_event","shift","handleFn","actionsHandler","EventsMapping","on","eventName","callback","eventsCallback","add","off","Object","values","l","clear","Select","clientActions","SELECT","Visibility_changed","VISIBILITY_CHANGED","Focus_changed","FOCUS_CHANGED","Project_loading","PROJECT_LOADING","Project_loaded","PROJECT_LOADED","Project_downloaded","PROJECT_DOWNLOADED","Model_loaded","MODEL_LOADED","ModelTree_populated","MODELTREE_POPULATED","SimulationTree_populated","SIMULATIONTREE_POPULATED","Instance_deleted","INSTANCE_DELETED","Instances_created","INSTANCES_CREATED","Instance_added","INSTANCE_ADDED","Show_spinner","SHOW_SPINNER","Hide_spinner","HIDE_SPINNER","Color_set","COLOR_SET","Project_made_public","PROJECT_MADE_PUBLIC","Lit_entities_changed","LIT_ENTITIES_CHANGED","Component_destroyed","COMPONENT_DESTROYED","Project_properties_saved","PROJECT_PROPERTIES_SAVED","Parameters_set","PARAMETERS_SET","Receive_Python_Message","RECEIVE_PYTHON_MESSAGE","Websocket_disconnected","WEBSOCKET_DISCONNECTED","Error_while_exec_python_command","ERROR_WHILE_EXEC_PYTHON_COMMAND","Jupyter_geppetto_extension_ready","JUPYTER_GEPPETTO_EXTENSION_READY","initGeppetto","useWebsocket","loadStyle","GEPPETTO_CONFIGURATION","WSMain","init","MessageSocket","socket"],"sources":["../src/GEPPETTO.js"],"sourcesContent":["/**\n *\n * @author Matteo Cantarelli\n * @authot Jesus R Martinez (jesus@metacell.us)\n * @deprecated\n */\n\n\nconst EventManager = require('./common/EventManager').default;\nconst Events = require('./Events').default;\nconst Resources = require('@metacell/geppetto-meta-core/Resources').default;\n\n\nconst Manager = require('./common/GeppettoManager').default;\nconst ComponentFactory = require('./components/ComponentFactory').default;\n\nconst ModelFactory = require('@metacell/geppetto-meta-core/ModelFactory').default;\nrequire('./style/less/main.less')\n\n/**\n * Initialise Geppetto\n *\n * @class GEPPETTO\n */\nconst GEPPETTO = {\n\n  debug: true,\n  Resources,\n  Manager,\n  ModelFactory,\n  Events,\n  /**\n   * @param{String} key - The pressed key\n   * @returns {boolean} True if the key is pressed\n   */\n  isKeyPressed: function (key) {\n    return this.keyboard.pressed(key);\n  },\n\n  /**\n   * @param msg\n   */\n  log: function (msg) {\n\n    var d = new Date();\n    var curr_hour = d.getHours();\n    var curr_min = d.getMinutes();\n    var curr_sec = d.getSeconds();\n    var curr_msec = d.getMilliseconds();\n    console.debug(curr_hour + \":\" + curr_min + \":\" + curr_sec + \":\" + curr_msec + ' - ' + msg, \"\");\n\n  },\n\n  /**\n   * @param category\n   * @param action\n   * @param opt_label\n   * @param opt_value\n   * @param opt_noninteraction\n   */\n  trackActivity: function (category, action, opt_label, opt_value, opt_noninteraction) {\n    if (typeof _gaq != 'undefined') {\n      _gaq.push(['_trackEvent', category, action, opt_label, opt_value, opt_noninteraction]);\n    }\n  },\n\n  winHeight: function () {\n    return window.innerHeight || (document.documentElement || document.body).clientHeight;\n  },\n\n  trigger: function (...args) {\n    if (args.length == 0) {\n      console.error(\"Trigger should be provided of the event to trigger\");\n      return;\n    } else {\n      const _event = args.shift();\n      const handleFn = EventManager.actionsHandler[EventsMapping[_event]];\n      if (handleFn) {\n        handleFn(...args);\n      }\n    }\n  },\n\n  on: function (eventName, callback) {\n    EventManager.eventsCallback[EventsMapping[eventName]].add(callback)\n  },\n\n  off: function (eventName, callback = null) {\n    if (!eventName && callback) {\n      for (const l of Object.values(EventManager.eventsCallback)) {\n        EventManager.eventsCallback[EventsMapping[l]].delete(callback)\n      }\n    } else if (eventName && !callback) {\n      EventManager.eventsCallback[EventsMapping[eventName]].clear()\n    } else if (eventName && callback) {\n      EventManager.eventsCallback[EventsMapping[eventName]].delete(callback)\n    } else {\n      for (const l of Object.values(EventManager.eventsCallback)) {\n        EventManager.eventsCallback[EventsMapping[l]].clear(callback)\n      }\n    }\n  },\n};\n\nconst EventsMapping = {\n  [Events.Select]: EventManager.clientActions.SELECT,\n  [Events.Visibility_changed]: EventManager.clientActions.VISIBILITY_CHANGED,\n  [Events.Focus_changed]: EventManager.clientActions.FOCUS_CHANGED,\n  [Events.Project_loading]: EventManager.clientActions.PROJECT_LOADING,\n  [Events.Project_loaded]: EventManager.clientActions.PROJECT_LOADED,\n  [Events.Project_downloaded]: EventManager.clientActions.PROJECT_DOWNLOADED,\n  [Events.Model_loaded]: EventManager.clientActions.MODEL_LOADED,\n  [Events.ModelTree_populated]: EventManager.clientActions.MODELTREE_POPULATED,\n  [Events.SimulationTree_populated]: EventManager.clientActions.SIMULATIONTREE_POPULATED,\n  [Events.Instance_deleted]: EventManager.clientActions.INSTANCE_DELETED,\n  [Events.Instances_created]: EventManager.clientActions.INSTANCES_CREATED,\n  [Events.Instance_added]: EventManager.clientActions.INSTANCE_ADDED,\n  [Events.Show_spinner]: EventManager.clientActions.SHOW_SPINNER,\n  [Events.Hide_spinner]: EventManager.clientActions.HIDE_SPINNER,\n  [Events.Color_set]: EventManager.clientActions.COLOR_SET,\n  [Events.Project_made_public]: EventManager.clientActions.PROJECT_MADE_PUBLIC,\n  [Events.Lit_entities_changed]: EventManager.clientActions.LIT_ENTITIES_CHANGED,\n  [Events.Component_destroyed]: EventManager.clientActions.COMPONENT_DESTROYED,\n  [Events.Project_properties_saved]: EventManager.clientActions.PROJECT_PROPERTIES_SAVED,\n  [Events.Parameters_set]: EventManager.clientActions.PARAMETERS_SET,\n  [Events.Receive_Python_Message]: EventManager.clientActions.RECEIVE_PYTHON_MESSAGE,\n  [Events.Websocket_disconnected]: EventManager.clientActions.WEBSOCKET_DISCONNECTED,\n  [Events.Error_while_exec_python_command]: EventManager.clientActions.ERROR_WHILE_EXEC_PYTHON_COMMAND,\n  [Events.Jupyter_geppetto_extension_ready]: EventManager.clientActions.JUPYTER_GEPPETTO_EXTENSION_READY,\n};\n\nexport function initGeppetto (useWebsocket = true, loadStyle = true) {\n  if (!window.GEPPETTO_CONFIGURATION) {\n    window.GEPPETTO_CONFIGURATION = {}\n  }\n  if (useWebsocket) {\n    const WSMain = require('./WebsocketMain').default;\n    WSMain.init();\n    GEPPETTO.MessageSocket = WSMain.socket\n  }\n\n  if (loadStyle) {\n    require('./style/less/main.less');\n  }\n\n  GEPPETTO.ComponentFactory = ComponentFactory;\n  window.GEPPETTO = GEPPETTO;\n}\n\nexport default GEPPETTO;\n\n\n"],"mappings":"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"}