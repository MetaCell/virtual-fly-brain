{"version":3,"file":"interactable.js","names":["_propTypes","require","_Events","_typeof","o","Symbol","iterator","constructor","prototype","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","key","value","_toPropertyKey","configurable","writable","i","_toPrimitive","toPrimitive","call","TypeError","String","Number","clicked","target","detail","event","CustomEvent","dispatchEvent","AFRAME","registerComponent","schema","id","type","reversed","closerDistance","init","_this","el","data","scene","document","getElementById","concat","model","camera","rhand","lhand","handOldPos","baseRotation","x","y","z","previousHandRotation","originalPosition","parent","addEventListener","evt","object3D","rotation","BRING_CLOSER","selected","attach","position","set","closerPosition","getCloserPosition","cameraPos","bbox","THREE","Box3","setFromObject","center","getCenter","getWorldPosition","xDiff","zDiff","getZDist","yDiff","getYDist","cPos","tick","_this$data","isExpanding","scale","addScalar","rotate","_x","_y","rightXGrowing","leftXDecreasing","objPos","objBox","axis","diff1","Math","abs","min","diff2","max","closerDist","diff","convertToLocalCoordinates","newWorldPosition","localPosition","worldPosition"],"sources":["../../../src/vr-canvas/aframe/interactable.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport { object } from 'prop-types';\nimport { BRING_CLOSER } from '../Events';\n\nfunction clicked (target, detail) {\n  const event = new CustomEvent('mesh_click', { detail: detail });\n  target.dispatchEvent(event);\n}\n\nAFRAME.registerComponent('interactable', {\n  schema: {\n    id: { type: 'string' },\n    reversed: { default: true },\n    closerDistance: { default: 1 },\n  },\n  init: function () {\n    const { el } = this;\n    const { id } = this.data;\n    const scene = document.getElementById(`${id}_scene`);\n    const model = document.getElementById(`${id}_model`);\n    const camera = document.getElementById(`${id}_camera`);\n    this.rhand = false;\n    this.lhand = false;\n    this.handOldPos = { rhand: null, lhand: null };\n    this.baseRotation = {\n      rhand: { x: 0, y: 0, z: 0 },\n      lhand: { x: 0, y: 0, z: 0 },\n    };\n    this.previousHandRotation = {\n      rhand: { x: 0, y: 0, z: 0 },\n      lhand: { x: 0, y: 0, z: 0 },\n    };\n    this.originalPosition = null;\n    this.parent = null;\n\n    el.addEventListener('mouseenter', () => {\n      const event = new CustomEvent('mesh_hover', { detail: el });\n      scene.dispatchEvent(event);\n    });\n\n    el.addEventListener('mouseleave', () => {\n      const event = new CustomEvent('mesh_hover_leave', { detail: el });\n      scene.dispatchEvent(event);\n    });\n\n    el.addEventListener('triggerdown', () => {\n      clicked(scene, el);\n    });\n\n    el.addEventListener('click', () => {\n      clicked(scene, el);\n    });\n\n    el.addEventListener('gripdown', evt => {\n      if (evt.detail === `${id}_rightHand`) {\n        this.rhand = document.getElementById(evt.detail);\n        this.baseRotation.rhand = el.object3D.rotation;\n        this.previousHandRotation.rhand = { ...this.rhand.object3D.rotation };\n      } else if (evt.detail === `${id}_leftHand`) {\n        this.lhand = document.getElementById(evt.detail);\n        this.baseRotation.lhand = el.object3D.rotation;\n        this.previousHandRotation.lhand = { ...this.lhand.object3D.rotation };\n      }\n    });\n\n    el.addEventListener('gripup', evt => {\n      /*\n       * if (evt.detail === `${id}_rightHand`) {\n       *   this.rhand = null;\n       * } else if (evt.detail === `${id}_leftHand`) {\n       *   this.lhand = null;\n       * }\n       */\n      this.rhand = null;\n      this.lhand = null;\n    });\n\n    el.addEventListener(BRING_CLOSER, () => {\n      const { closerDistance } = this.data;\n      if (el.selected || el.id === `${id}_model`) {\n        if (this.originalPosition) {\n          if (el.id !== `${id}_model`) {\n            model.object3D.attach(el.object3D);\n          }\n          el.object3D.position.set(\n            this.originalPosition.x,\n            this.originalPosition.y,\n            this.originalPosition.z\n          );\n          this.originalPosition = null;\n        } else {\n          this.originalPosition = { ...el.object3D.position };\n          const closerPosition = this.getCloserPosition(\n            el.object3D,\n            camera.object3D.position,\n            closerDistance\n          );\n          scene.object3D.attach(el.object3D);\n          el.object3D.position.set(\n            closerPosition.x,\n            closerPosition.y,\n            closerPosition.z\n          );\n        }\n      }\n    });\n  },\n  getCloserPosition (obj, cameraPos, closerDistance) {\n    const bbox = new THREE.Box3().setFromObject(obj);\n    const center = bbox.getCenter();\n    const position = obj.getWorldPosition();\n    const xDiff = position.x - center.x;\n    const zDiff = this.getZDist(cameraPos, position, bbox, 'z');\n    const yDiff = this.getYDist(cameraPos, position, bbox, 'y');\n    const cPos = { ...cameraPos };\n    cPos.z -= zDiff + closerDistance;\n    cPos.y += yDiff;\n    cPos.x += xDiff;\n    return cPos;\n  },\n  tick: function () {\n    const { el } = this;\n    const { reversed, id } = this.data;\n    if (el.selected || el.id === `${id}_model`) {\n      if (this.rhand && this.lhand) {\n        if (this.handOldPos.rhand && this.handOldPos.lhand) {\n          if (this.isExpanding()) {\n            el.object3D.scale.addScalar(0.001);\n          } else {\n            el.object3D.scale.addScalar(-0.001);\n          }\n        }\n        this.handOldPos.rhand = { ...this.rhand.object3D.position };\n        this.handOldPos.lhand = { ...this.lhand.object3D.position };\n      } else if (this.rhand) {\n        let rotate = {\n          x:\n            this.rhand.object3D.rotation.x - this.previousHandRotation.rhand._x,\n          y:\n            this.rhand.object3D.rotation.y - this.previousHandRotation.rhand._y,\n          // z: this.rhand.object3D.rotation.z - this.previousHandRotation._z,\n        };\n        if (reversed) {\n          rotate = {\n            x: rotate.x * -1,\n            y: rotate.y * -1,\n            z: rotate.z * -1,\n          };\n        }\n        el.object3D.rotation.x = this.baseRotation.rhand.x + rotate.x;\n        el.object3D.rotation.y = this.baseRotation.rhand.y + rotate.y;\n        this.previousHandRotation.rhand = { ...this.rhand.object3D.rotation };\n      } else if (this.lhand) {\n        let rotate = {\n          // eslint-disable-next-line no-underscore-dangle\n          x:\n            this.lhand.object3D.rotation.x - this.previousHandRotation.lhand._x,\n          // eslint-disable-next-line no-underscore-dangle\n          y:\n            this.lhand.object3D.rotation.y - this.previousHandRotation.lhand._y,\n          // z: this.rhand.object3D.rotation.z - this.previousHandRotation._z,\n        };\n        if (reversed) {\n          rotate = {\n            x: rotate.x * -1,\n            y: rotate.y * -1,\n            z: rotate.z * -1,\n          };\n        }\n        el.object3D.rotation.x = this.baseRotation.lhand.x + rotate.x;\n        el.object3D.rotation.y = this.baseRotation.lhand.y + rotate.y;\n        this.previousHandRotation.lhand = { ...this.lhand.object3D.rotation };\n      }\n    }\n  },\n\n  isExpanding () {\n    const rightXGrowing\n      = this.rhand.object3D.position.x - this.handOldPos.rhand.x >= 0;\n    const leftXDecreasing\n      = this.lhand.object3D.position.x - this.handOldPos.lhand.x <= 0;\n    return rightXGrowing && leftXDecreasing;\n  },\n\n  getZDist (cameraPos, objPos, objBox, axis) {\n    const diff1 = Math.abs(cameraPos[axis] - objBox.min[axis]);\n    const diff2 = Math.abs(cameraPos[axis] - objBox.max[axis]);\n    const closerDist = diff1 < diff2 ? objBox.min[axis] : objBox.max[axis];\n    return Math.abs(objPos[axis] - closerDist);\n  },\n\n  getYDist (cameraPos, objPos, objBox, axis) {\n    const center = objBox.getCenter();\n    const diff = Math.abs(objPos[axis] - center[axis]);\n    if (cameraPos[axis] - diff < 0) {\n      return objPos[axis] - objBox.min[axis] - cameraPos[axis];\n    }\n    return diff - cameraPos[axis];\n  },\n\n  convertToLocalCoordinates (newWorldPosition, obj) {\n    const localPosition = obj.position;\n    const worldPosition = obj.getWorldPosition();\n    newWorldPosition.x\n      = (newWorldPosition.x * localPosition.x) / worldPosition.x;\n    newWorldPosition.y\n      = (newWorldPosition.y * localPosition.y) / worldPosition.y;\n    newWorldPosition.z\n      = (newWorldPosition.z * localPosition.z) / worldPosition.z;\n    return newWorldPosition;\n  },\n});\n"],"mappings":"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","ignoreList":[]}